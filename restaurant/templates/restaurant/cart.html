{% extends 'base.html' %}

{% block content %}
<div class="container">
    <div class="cart-section">
        <h2>Ваша корзина</h2>

        {% if cart_items %}
            <ul class="cart-list">
                {% for item in cart_items %}
                    <li class="cart-item">
                        <div class="cart-info">
                            <span class="cart-dish-name">{{ item.dish.name }}</span>
                            <span class="cart-dish-details">
                                {{ item.quantity }} × {{ item.dish.price }}₽ = <strong>{{ item.subtotal }}₽</strong>
                            </span>
                        </div>
                        <div class="cart-actions">
                            <form action="{% url 'add_to_cart' item.dish.id %}" method="post">{% csrf_token %}
                                <button type="submit" class="cart-btn">+</button>
                            </form>
                            <form action="{% url 'remove_from_cart' item.dish.id %}" method="post">{% csrf_token %}
                                <button type="submit" class="cart-btn">–</button>
                            </form>
                            <form action="{% url 'delete_from_cart' item.dish.id %}" method="post">{% csrf_token %}
                                <button type="submit" class="cart-btn delete-btn">Удалить</button>
                            </form>
                        </div>
                    </li>
                {% endfor %}
            </ul>

            <p class="cart-total"><strong>Итого: {{ total }}₽</strong></p>

            <div class="cart-controls">
                <form action="{% url 'clear_cart' %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="cart-control-btn">Очистить корзину</button>
                </form>
                <form action="{% url 'place_order' %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="cart-control-btn">Оформить заказ</button>
                </form>
            </div>
        {% else %}
            <p class="cart-empty">Корзина пуста.</p>
        {% endif %}
    </div>
</div>

<style>
    .cart-section {
        margin-top: 40px;
        text-align: left;
    }

    .cart-list {
        list-style: none;
        padding: 0;
        margin: 20px 0;
    }

    .cart-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 15px;
        margin: 8px 0;
        background: white;
        border-radius: 5px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        flex-wrap: wrap;
    }

    .cart-info {
        flex-grow: 1;
    }

    .cart-dish-name {
        font-weight: bold;
    }

    .cart-dish-details {
        margin-left: 10px;
        color: #4CAF50;
        font-weight: bold;
    }

    .cart-actions {
        display: flex;
        gap: 8px;
        margin-top: 10px;
    }

    .cart-btn {
        background: #4CAF50;
        color: white;
        border: none;
        border-radius: 5px;
        padding: 5px 10px;
        cursor: pointer;
        transition: background 0.3s;
    }

    .cart-btn:hover {
        background: #45a049;
    }

    .delete-btn {
        background: #f44336;
    }

    .delete-btn:hover {
        background: #d32f2f;
    }

    .cart-total {
        font-size: 18px;
        margin-top: 20px;
        text-align: right;
    }

    .cart-controls {
        display: flex;
        gap: 15px;
        margin-top: 20px;
        justify-content: flex-end;
    }

    .cart-control-btn {
        background: #4CAF50;
        color: white;
        border: none;
        border-radius: 5px;
        padding: 10px 20px;
        font-weight: bold;
        cursor: pointer;
        transition: background 0.3s;
    }

    .cart-control-btn:hover {
        background: #45a049;
    }

    .cart-empty {
        font-style: italic;
        color: #999;
        margin-top: 20px;
    }
</style>
{% endblock %}
